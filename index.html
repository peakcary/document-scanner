<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文档扫描器</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>文档扫描器</h1>
            <p>将文档照片转换为高质量PDF扫描件</p>
        </div>

        <div class="upload-section">
            <div class="tabs">
                <button class="tab-btn active" data-tab="camera">拍照</button>
                <button class="tab-btn" data-tab="upload">上传图片</button>
            </div>

            <div class="tab-content active" id="camera-tab">
                <div class="camera-container">
                    <video id="video" autoplay playsinline></video>
                    <canvas id="canvas" style="display: none;"></canvas>
                    <div class="camera-controls">
                        <button id="start-camera" class="btn primary">启动摄像头</button>
                        <button id="capture" class="btn secondary" style="display: none;">拍照</button>
                        <button id="switch-camera" class="btn secondary" style="display: none;">切换摄像头</button>
                    </div>
                </div>
            </div>

            <div class="tab-content" id="upload-tab">
                <div class="upload-area" id="upload-area">
                    <input type="file" id="file-input" multiple accept="image/*" style="display: none;">
                    <div class="upload-text">
                        <p>点击或拖拽图片到此处</p>
                        <p class="upload-hint">支持多张图片上传</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="preview-section" id="preview-section" style="display: none;">
            <h3>预览图片</h3>
            <div class="image-list" id="image-list"></div>
            <div class="controls">
                <button id="clear-all" class="btn secondary">清空</button>
                <button id="preview-processing" class="btn secondary">预览处理效果</button>
                <button id="process-images" class="btn primary">处理并生成PDF</button>
            </div>
        </div>

        <div class="processing-preview-section" id="processing-preview-section" style="display: none;">
            <h3>处理效果预览</h3>
            <div class="processed-image-list" id="processed-image-list"></div>
            <div class="controls">
                <button id="back-to-preview" class="btn secondary">返回编辑</button>
                <button id="confirm-processing" class="btn primary">确认并生成PDF</button>
            </div>
        </div>

        <div class="processing-section" id="processing-section" style="display: none;">
            <div class="progress-bar">
                <div class="progress" id="progress"></div>
            </div>
            <p id="status-text">正在处理图片...</p>
        </div>

        <div class="result-section" id="result-section" style="display: none;">
            <h3>处理完成</h3>
            <div class="export-options">
                <h4>导出格式</h4>
                <div class="format-options">
                    <label><input type="radio" name="format" value="pdf" checked> PDF</label>
                    <label><input type="radio" name="format" value="zip"> ZIP压缩包</label>
                </div>
                <h4>页面尺寸</h4>
                <div class="page-size-options">
                    <label><input type="radio" name="pageSize" value="a4" checked> A4</label>
                    <label><input type="radio" name="pageSize" value="a3"> A3</label>
                    <label><input type="radio" name="pageSize" value="letter"> Letter</label>
                </div>
                <h4>其他选项</h4>
                <div class="other-options">
                    <label><input type="checkbox" id="ocr-text"> 启用OCR文字识别</label>
                </div>
            </div>
            <div class="controls">
                <button id="download-files" class="btn primary">下载文件</button>
                <button id="start-over" class="btn secondary">重新开始</button>
            </div>
        </div>
    </div>

    <!-- 图片编辑模态框 -->
    <div class="modal" id="image-editor-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>编辑图片</h3>
                <button class="close-btn" id="close-editor">&times;</button>
            </div>
            <div class="modal-body">
                <div class="editor-container">
                    <canvas id="editor-canvas"></canvas>
                    <div class="corner-points" id="corner-points">
                        <div class="corner-point" data-corner="0"></div>
                        <div class="corner-point" data-corner="1"></div>
                        <div class="corner-point" data-corner="2"></div>
                        <div class="corner-point" data-corner="3"></div>
                    </div>
                </div>
                <div class="editor-controls">
                    <button id="auto-detect" class="btn secondary">自动检测边框</button>
                    <button id="rotate-left" class="btn secondary">↺ 左转</button>
                    <button id="rotate-right" class="btn secondary">↻ 右转</button>
                    <button id="apply-changes" class="btn primary">应用修改</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 全屏预览模态框 -->
    <div class="modal" id="fullscreen-modal">
        <div class="modal-content fullscreen">
            <button class="close-btn" id="close-fullscreen">&times;</button>
            <div class="fullscreen-container">
                <img id="fullscreen-image" src="" alt="">
                <div class="fullscreen-controls">
                    <button id="zoom-in" class="btn secondary">放大</button>
                    <button id="zoom-out" class="btn secondary">缩小</button>
                    <button id="zoom-reset" class="btn secondary">重置</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/opencv.js/4.8.0/opencv.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tesseract.js/4.1.1/tesseract.min.js"></script>
    <script src="js/image-processor.js"></script>
    <script src="js/app.js"></script>
</body>
</html>